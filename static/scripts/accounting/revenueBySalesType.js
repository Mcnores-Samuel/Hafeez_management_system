$(document).ready(function () {
    const loader = $('#loader');

    const cash_url = '/system_core_1/calculateCashRevenue/';
    const yellow_url = '/system_core_1/calculateCreditRevenue/';
    
    function fetchData(url) {
        $.ajax({
        url: url,
        method: 'GET',
        contentType: 'application/json',
        beforeSend() {
            loader.show();
        },
        success(data) {
            loader.hide();
            if (url === cash_url) {
                revByCashSales(data);
            } else {
                revByYellowSales(data);
            }
        },
        });
    }
    
    fetchData(cash_url);
    fetchData(yellow_url);
});


function revByYellowSales(data) {
    let revByYellowSalesChart = null;
    let revByYellowSalesctx = null;
    if (revByYellowSalesChart === null) {
        revByYellowSalesctx = $('.revByYellowSalesChart').get(0).getContext('2d');
    }
    const modelList = [];
    const revenue = [];
    $.each(data, function (key, value) {
        modelList.push(key);
        revenue.push(value);
    });

    revByYellowSalesChart = new Chart(revByYellowSalesctx, {
        type: 'line',
        data: {
            labels: modelList,
            datasets: [
                {
                    label: 'Revenue generated by Yellow Sales',
                    data: revenue,
                    backgroundColor: "rgba(4, 216, 216, 0.8)",
                    fill: true,
                    tension: 0.4,
                    yAxisID: 'y',
                    order: 1,
                },
            ],
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
        },
    });
}

function revByCashSales(data) {
    let revByCashSalesChart = null;
    let revByCashSalesctx = null;
    if (revByCashSalesChart === null) {
        revByCashSalesctx = $('.revByCashSalesChart').get(0).getContext('2d');
    }
    const modelList = [];
    const revenue = [];
    $.each(data, function (key, value) {
        modelList.push(key);
        revenue.push(value);
    });

    revByCashSalesChart = new Chart(revByCashSalesctx, {
        type: 'line',
        data: {
            labels: modelList,
            datasets: [
                {
                    label: 'Revenue generated by Cash Sales',
                    data: revenue,
                    backgroundColor: "rgba(204, 20, 164, 0.8)",
                    fill: true,
                    tension: 0.4,
                    yAxisID: 'y',
                    order: 1,
                },
            ],
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
        },
    });
}